var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};define(["Phaser","KinematicSteeringOutput","KinematicSeekFlee","KinematicArrive","KinematicWander","Seek","Arrive","Align","VelocityMatch","Pursue"],function(e,t,n,r,i,s,o,u,a,f){var l;l=function(l){function c(n,r,i,s,o,u,a){a==null&&(a=null);this.steering=new t;this.game=n;this.timeNow=function(){return Math.floor(this.game.time.time/1e3)%60};this.time=1;this.behavior=u;this.wanderCounter=0;this.wanderReset=50;this.maxSpeed=4;this.log=a!=null?!0:!1;this.logConfig=a[0];this.velocity=new e.Point;this.position=this.world;this.orientation=0;e.Sprite.call(this,n,r,i,s);this.anchor.setTo(.5,.5);this.graphics=new e.Graphics(this.game,0,0);this.line=this.game.add.graphics(0,0);if(this.log===!0){window.graphics=this.graphics;window.game=this.game;window.line=this.line;window.world=this.world;window.Phaser=e;window.sprite=this;window.time=this.time}}__extends(c,l);c.prototype.getTarget=function(){return this.target};c.prototype.setTarget=function(e){return this.target=e};c.prototype.create=function(){var e,t;this.game.add.existing(this);this.frame=4;t="niel's Game";e={font:"11 Arial",fill:"#ff0044",align:"left"};if(this.log===!0)return this.logConfig.position==="left"?this.logger=this.game.add.text(this.game.world.centerX-300,this.game.world.centerY-100,t,e):this.logger=this.game.add.text(this.game.world.centerX,this.game.world.centerY-100,t,e)};c.prototype.update=function(){var t;if(this.target!=null){switch(this.behavior){case"seek":this.movement=new n(this,this.target,.1,!0);break;case"flee":this.movement=new n(this,this.target,.1,!1);break;case"arrive":this.movement=new r(this,this.target,1,25,1.25);break;case"wander":this.movement=new i(this,6,2);break;case"seekDyn":this.movement=new s(this,this.target,2);break;case"fleeDyn":this.movement=new s(this,this.target,2,!1);break;case"arriveDyn":this.movement=new o(this,this.target,2,this.maxSpeed,10,300);break;case"alignDyn":this.movement=new u(this,this.target,10,4,10,300);break;case"velocityMatchDyn":this.movement=new a(this,this.target,10);break;case"pursueDel":this.movement=new f(this,this.target,.5,2)}this.movement!=null&&(this.newSteering=this.movement.getSteering());this.newSteering!=null?this.steering=this.newSteering:this.velocity.setTo(0,0)}if(this.steering!=null){this.position=e.Point.add(this.position,this.velocity.multiply(this.time,this.time));this.orientation+=this.rotation*this.time;this.steering.velocity.x!==0&&this.steering.velocity.y!==0?this.velocity=this.steering.velocity:this.velocity=e.Point.add(this.velocity,this.steering.linear.multiply(this.time,this.time));this.steering.rotation!==0?this.rotation=this.steering.rotation:this.rotation+=this.steering.angular*this.time;if(this.velocity.getMagnitude()>this.maxSpeed){this.velocity.normalize();this.velocity.multiply(this.maxSpeed,this.maxSpeed)}if(this.log===!0){window.movement=this.movement;t="steering linear x:"+this.steering.linear.x+" y:"+this.steering.linear.y;t+="\nsteering angular "+this.steering.angular;t+="\nsteering velocity x:"+this.steering.velocity.x+" y:"+this.steering.velocity.y;t+="\nsteering rotation "+this.steering.rotation;t+="\nposition x:"+this.position.x+" y:"+this.position.y;t+="\nvelocity x:"+this.velocity.x+" y:"+this.velocity.y;t+="\norientation: "+this.orientation;t+="\nrotation: "+this.rotation;t+="\nposition magnitude: "+this.position.getMagnitude();this.logger.setText(t)}return this.render()}};c.prototype.render=function(){var e;if(this.log===!0){e=this.logConfig.lineColor!=null?this.logConfig.lineColor:16711680;this.line.beginFill(e);this.line.lineStyle(1,e,1);this.line.moveTo(this.x,this.y);this.line.lineTo(this.position.x,this.position.y);this.line.endFill()}this.x=this.position.x;this.y=this.position.y;if(this.game.time.fps<40)return this.line.clear()};return c}(e.Sprite);return l});